<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>Quản lý đơn hàng</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-light">

    <nav class="navbar navbar-expand-lg navbar-dark bg-primary sticky-top shadow">
        <div class="container">
            <a class="navbar-brand fw-bold" href="index.html"><i class="fa-solid fa-arrow-left me-2"></i> TRANG CHỦ</a>
            <div class="d-flex align-items-center gap-3" id="authArea"></div>
        </div>
    </nav>

    <div class="container my-5">
        <div class="card shadow border-0 rounded-4">
            <div class="card-header bg-white py-3">
                <h4 class="fw-bold mb-0 text-primary"><i class="fa-solid fa-box-open me-2"></i> Đơn hàng của tôi</h4>
            </div>
            <div class="card-body p-0">
                <div class="table-responsive">
                    <table class="table table-hover align-middle mb-0">
                        <thead class="bg-light">
                            <tr>
                                <th class="ps-4">Mã đơn</th>
                                <th>Ngày đặt</th>
                                <th>Tổng tiền</th>
                                <th>Trạng thái</th>
                                <th class="text-end pe-4">Hành động</th>
                            </tr>
                        </thead>
                        <tbody id="order-history-list">
                            <tr><td colspan="5" class="text-center py-4">Đang tải...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="orderDetailModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title fw-bold">Chi tiết đơn hàng #<span id="modal-order-id"></span></h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <div class="col-md-5 border-end">
                            <h6 class="fw-bold text-primary mb-3">Thông tin nhận hàng</h6>
                            <form id="form-update-order">
                                <div class="mb-2">
                                    <label class="small text-muted">Người nhận</label>
                                    <input type="text" id="modal-name" class="form-control form-control-sm">
                                </div>
                                <div class="mb-2">
                                    <label class="small text-muted">Số điện thoại</label>
                                    <input type="text" id="modal-phone" class="form-control form-control-sm">
                                </div>
                                <div class="mb-2">
                                    <label class="small text-muted">Địa chỉ</label>
                                    <textarea id="modal-address" class="form-control form-control-sm" rows="2"></textarea>
                                </div>
                                <div class="mb-3">
                                    <label class="small text-muted">Ghi chú</label>
                                    <input type="text" id="modal-note" class="form-control form-control-sm">
                                </div>
                                
                                <button type="button" id="btn-save-info" class="btn btn-primary btn-sm w-100 d-none" onclick="saveOrderInfo()">
                                    <i class="fa-solid fa-floppy-disk"></i> Lưu thay đổi
                                </button>
                                <div id="msg-locked" class="alert alert-warning py-1 small mt-2 d-none">
                                    <i class="fa-solid fa-lock"></i> Đơn đã duyệt, không thể sửa thông tin.
                                </div>
                            </form>
                        </div>

                        <div class="col-md-7">
                            <h6 class="fw-bold text-primary mb-3">Sản phẩm đã đặt</h6>
                            <div class="list-group list-group-flush border rounded overflow-auto" style="max-height: 300px;" id="modal-items-list">
                                </div>
                            <div class="d-flex justify-content-between mt-3 fw-bold fs-5">
                                <span>Tổng cộng:</span>
                                <span class="text-danger" id="modal-total">0 đ</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer bg-light" id="modal-footer-actions">
                    </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/orders.js"></script> 
</body>
</html>